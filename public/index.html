<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excentrica - Santiago del Estero</title>
    <meta name="description" content="Red social y marketplace de Santiago del Estero, Argentina. Noticias, eventos, productos y mas.">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="icon" href="/images/favicon.ico">
    <style>
        /* Home page specific styles */
        .home-section {
            margin-bottom: 2rem;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .section-title .icon {
            font-size: 1.3rem;
        }

        /* News feed cards */
        .news-feed {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .news-card {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        .news-card:hover {
            border-color: rgba(168, 85, 247, 0.4);
            transform: translateY(-2px);
        }
        .news-card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .news-card-body {
            padding: 1rem;
        }
        .news-card-category {
            display: inline-block;
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            margin-bottom: 0.5rem;
        }
        .news-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }
        .news-card-title a {
            color: inherit;
            text-decoration: none;
        }
        .news-card-title a:hover {
            color: #a855f7;
        }
        .news-card-excerpt {
            color: #94a3b8;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 0.75rem;
        }
        .news-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #64748b;
            font-size: 0.8rem;
        }

        /* Product cards grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        .product-card {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        .product-card:hover {
            border-color: rgba(168, 85, 247, 0.4);
            transform: translateY(-2px);
        }
        .product-card-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        .product-card-body {
            padding: 0.75rem;
        }
        .product-card-title {
            font-size: 0.9rem;
            font-weight: 500;
            color: #e2e8f0;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .product-card-title a {
            color: inherit;
            text-decoration: none;
        }
        .product-card-price {
            font-size: 1.1rem;
            font-weight: 700;
            color: #22c55e;
        }
        .product-card-zone {
            font-size: 0.75rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        /* Event cards */
        .events-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .event-card {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            gap: 1rem;
            align-items: center;
            transition: all 0.2s ease;
        }
        .event-card:hover {
            border-color: rgba(168, 85, 247, 0.4);
        }
        .event-date {
            background: rgba(168, 85, 247, 0.2);
            border-radius: 10px;
            padding: 0.75rem;
            text-align: center;
            min-width: 60px;
        }
        .event-date-day {
            font-size: 1.5rem;
            font-weight: 700;
            color: #a855f7;
            line-height: 1;
        }
        .event-date-month {
            font-size: 0.7rem;
            color: #94a3b8;
            text-transform: uppercase;
        }
        .event-info {
            flex: 1;
        }
        .event-title {
            font-size: 1rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 0.25rem;
        }
        .event-title a {
            color: inherit;
            text-decoration: none;
        }
        .event-location {
            font-size: 0.85rem;
            color: #64748b;
        }

        /* Cinema section */
        .cinema-movies {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 1rem;
        }
        .movie-card {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        .movie-card:hover {
            border-color: rgba(168, 85, 247, 0.4);
            transform: translateY(-2px);
        }
        .movie-card-poster {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .movie-card-body {
            padding: 0.75rem;
        }
        .movie-card-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: #e2e8f0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .movie-card-genre {
            font-size: 0.7rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        /* POI (Tourism) section */
        .poi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }
        .poi-card {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        .poi-card:hover {
            border-color: rgba(168, 85, 247, 0.4);
            transform: translateY(-2px);
        }
        .poi-card-image {
            width: 100%;
            height: 140px;
            object-fit: cover;
        }
        .poi-card-body {
            padding: 0.75rem;
        }
        .poi-card-category {
            display: inline-block;
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            margin-bottom: 0.5rem;
        }
        .poi-card-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 0.25rem;
        }
        .poi-card-location {
            font-size: 0.8rem;
            color: #64748b;
        }

        /* Quick links grid */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .quick-link {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(30, 30, 40, 0.95));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 10px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            color: #e2e8f0;
            text-decoration: none;
            transition: all 0.2s ease;
        }
        .quick-link:hover {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(30, 30, 40, 0.95));
            border-color: rgba(168, 85, 247, 0.4);
            transform: translateY(-2px);
        }
        .quick-link .icon {
            font-size: 1.75rem;
        }
        .quick-link span:last-child {
            font-size: 0.85rem;
        }

        /* Sidebar widgets */
        .widget {
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.95), rgba(20, 20, 30, 0.98));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .widget-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .widget-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .widget-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 8px;
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }
        .widget-item:hover {
            background: rgba(168, 85, 247, 0.1);
            color: #e2e8f0;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #64748b;
        }
        .empty-state .icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        /* Loading spinner */
        .loading {
            display: flex;
            justify-content: center;
            padding: 2rem;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .cinema-movies {
                grid-template-columns: repeat(3, 1fr);
            }
            .quick-links {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar de Navegacion Lateral Fijo -->
    <nav class="sidebar-nav">
        <a href="/" class="sidebar-nav-item active">
            <span class="icon">üè†</span>
            <span>Inicio</span>
        </a>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title">Explorar</div>

        <a href="/noticias.html" class="sidebar-nav-item">
            <span class="icon">üì∞</span>
            <span>Noticias</span>
        </a>
        <a href="/mercaderia.html" class="sidebar-nav-item">
            <span class="icon">üõí</span>
            <span>Mercaderia</span>
        </a>
        <a href="/eventos.html" class="sidebar-nav-item">
            <span class="icon">üìÖ</span>
            <span>Eventos</span>
        </a>
        <a href="/videos.html" class="sidebar-nav-item">
            <span class="icon">üé¨</span>
            <span>Videos</span>
        </a>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title">Servicios</div>

        <a href="/gastronomia.html" class="sidebar-nav-item">
            <span class="icon">üçΩÔ∏è</span>
            <span>Gastronomia</span>
        </a>
        <a href="/alojamiento.html" class="sidebar-nav-item">
            <span class="icon">üè®</span>
            <span>Alojamiento</span>
        </a>
        <a href="/transporte.html" class="sidebar-nav-item">
            <span class="icon">üöå</span>
            <span>Transporte</span>
        </a>
        <a href="/servicios.html" class="sidebar-nav-item">
            <span class="icon">üîß</span>
            <span>Servicios</span>
        </a>
        <a href="/turismo.html" class="sidebar-nav-item">
            <span class="icon">üó∫Ô∏è</span>
            <span>Turismo</span>
        </a>

        <div class="sidebar-divider"></div>

        <a href="/cine.html" class="sidebar-nav-item">
            <span class="icon">üé¨</span>
            <span>Cine</span>
        </a>
        <a href="/contacto.html" class="sidebar-nav-item">
            <span class="icon">üìû</span>
            <span>Contacto</span>
        </a>
    </nav>

    <!-- Header Superior -->
    <header class="header">
        <div class="header-inner">
            <a href="/" class="logo">
                <span>‚ö°</span> Excentrica
            </a>

            <div class="header-search">
                <input type="search" id="global-search" placeholder="Buscar en Excentrica..." />
            </div>

            <div class="user-menu" id="user-menu"></div>

            <button class="menu-toggle" aria-label="Abrir menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="layout-sidebar">
            <!-- Feed principal -->
            <div class="content">
                <!-- Tarjeta de bienvenida -->
                <div class="welcome-card mb-4">
                    <h1 class="welcome-title">Bienvenido a <span class="text-accent">Excentrica</span></h1>
                    <p class="welcome-text">La red social de Santiago del Estero. Descubri noticias, eventos, productos y mucho mas de nuestra comunidad.</p>
                </div>

                <!-- Quick Links -->
                <div class="quick-links">
                    <a href="/noticias.html" class="quick-link">
                        <span class="icon">üì∞</span>
                        <span>Noticias</span>
                    </a>
                    <a href="/mercaderia.html" class="quick-link">
                        <span class="icon">üõí</span>
                        <span>Mercaderia</span>
                    </a>
                    <a href="/eventos.html" class="quick-link">
                        <span class="icon">üìÖ</span>
                        <span>Eventos</span>
                    </a>
                    <a href="/cine.html" class="quick-link">
                        <span class="icon">üé¨</span>
                        <span>Cartelera</span>
                    </a>
                    <a href="/turismo.html" class="quick-link">
                        <span class="icon">üó∫Ô∏è</span>
                        <span>Turismo</span>
                    </a>
                    <a href="/transporte.html" class="quick-link">
                        <span class="icon">üöå</span>
                        <span>Transporte</span>
                    </a>
                </div>

                <!-- Noticias -->
                <section class="home-section">
                    <div class="section-header">
                        <h2 class="section-title"><span class="icon">üì∞</span> Ultimas Noticias</h2>
                        <a href="/noticias.html" class="btn btn-outline btn-sm">Ver todas</a>
                    </div>
                    <div id="news-feed" class="news-feed">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </section>

                <!-- Productos -->
                <section class="home-section">
                    <div class="section-header">
                        <h2 class="section-title"><span class="icon">üõí</span> Productos Destacados</h2>
                        <a href="/mercaderia.html" class="btn btn-outline btn-sm">Ver todos</a>
                    </div>
                    <div id="products-grid" class="products-grid">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </section>

                <!-- Eventos -->
                <section class="home-section">
                    <div class="section-header">
                        <h2 class="section-title"><span class="icon">üìÖ</span> Proximos Eventos</h2>
                        <a href="/eventos.html" class="btn btn-outline btn-sm">Ver todos</a>
                    </div>
                    <div id="events-list" class="events-list">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </section>

                <!-- Cine / Cartelera -->
                <section class="home-section">
                    <div class="section-header">
                        <h2 class="section-title"><span class="icon">üé¨</span> Cartelera de Cine</h2>
                        <a href="/cine.html" class="btn btn-outline btn-sm">Ver cartelera</a>
                    </div>
                    <div id="movies-grid" class="cinema-movies">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </section>

                <!-- Turismo / POI -->
                <section class="home-section">
                    <div class="section-header">
                        <h2 class="section-title"><span class="icon">üó∫Ô∏è</span> Lugares para Visitar</h2>
                        <a href="/turismo.html" class="btn btn-outline btn-sm">Ver todos</a>
                    </div>
                    <div id="poi-grid" class="poi-grid">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </section>
            </div>

            <!-- Sidebar derecho -->
            <aside class="sidebar">
                <!-- Widget de usuario -->
                <div class="widget" id="user-widget">
                    <div class="widget-title">üë§ Mi Cuenta</div>
                    <div id="user-widget-content">
                        <p style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 0.75rem;">Inicia sesion para acceder a todas las funciones.</p>
                        <button class="btn btn-primary btn-block mb-2" onclick="window.location.href='/login.html'">Iniciar Sesion</button>
                        <button class="btn btn-outline btn-block" onclick="window.location.href='/registro.html'">Crear Cuenta</button>
                    </div>
                </div>

                <!-- Widget de categorias -->
                <div class="widget">
                    <div class="widget-title">üìÅ Categorias</div>
                    <div id="categories-widget" class="widget-list">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>

                <!-- Widget de zonas -->
                <div class="widget">
                    <div class="widget-title">üìç Zonas</div>
                    <div id="zones-widget" class="widget-list">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>

                <!-- Widget de redes sociales -->
                <div class="widget">
                    <div class="widget-title">üîó Seguinos</div>
                    <div class="social-icons-grid" style="display: flex; gap: 0.75rem; justify-content: center;">
                        <a href="https://facebook.com/excentrica" class="social-icon" target="_blank" rel="noopener" title="Facebook" style="font-size: 1.5rem;">üìò</a>
                        <a href="https://instagram.com/excentricaok" class="social-icon" target="_blank" rel="noopener" title="Instagram" style="font-size: 1.5rem;">üì∏</a>
                        <a href="https://youtube.com/revistaexcentrica" class="social-icon" target="_blank" rel="noopener" title="YouTube" style="font-size: 1.5rem;">üì∫</a>
                    </div>
                </div>

                <!-- Footer widget -->
                <div class="widget" style="text-align: center;">
                    <p style="color: #64748b; font-size: 0.8rem;">¬© 2026 Excentrica</p>
                    <p style="color: #64748b; font-size: 0.75rem;">Santiago del Estero, Argentina</p>
                </div>
            </aside>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <h4 class="footer-title">Excentrica</h4>
                    <p class="text-muted">Red social y marketplace de Santiago del Estero, Argentina.</p>
                </div>
                <div>
                    <h4 class="footer-title">Secciones</h4>
                    <div class="footer-links">
                        <a href="/noticias.html" class="footer-link">Noticias</a>
                        <a href="/mercaderia.html" class="footer-link">Mercaderia</a>
                        <a href="/eventos.html" class="footer-link">Eventos</a>
                        <a href="/videos.html" class="footer-link">Videos</a>
                    </div>
                </div>
                <div>
                    <h4 class="footer-title">Servicios</h4>
                    <div class="footer-links">
                        <a href="/gastronomia.html" class="footer-link">Gastronomia</a>
                        <a href="/alojamiento.html" class="footer-link">Alojamiento</a>
                        <a href="/transporte.html" class="footer-link">Transporte</a>
                        <a href="/turismo.html" class="footer-link">Turismo</a>
                    </div>
                </div>
                <div>
                    <h4 class="footer-title">Contacto</h4>
                    <div class="footer-links">
                        <span class="footer-link">contacto@excentrica.com.ar</span>
                        <span class="footer-link">Santiago del Estero, Argentina</span>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2026 Excentrica - Contenidos y Comunicacion. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/js/config.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/components.js"></script>
    <script src="/js/app.js"></script>
    <script>
        // Helper function to format date
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('es-AR', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        // Helper to get event date parts
        function getEventDateParts(dateStr) {
            if (!dateStr) return { day: '?', month: '???' };
            const date = new Date(dateStr);
            return {
                day: date.getDate(),
                month: date.toLocaleDateString('es-AR', { month: 'short' }).toUpperCase()
            };
        }

        // Helper to escape HTML
        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/[&<>"']/g, (m) => ({
                '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
            }[m]));
        }

        // Helper to truncate text
        function truncate(str, len) {
            if (!str) return '';
            return str.length > len ? str.substring(0, len) + '...' : str;
        }

        // Render news card
        function renderNewsCard(news) {
            const imageUrl = news.image_url || news.imageUrl || '/images/placeholder.jpg';
            return `
                <article class="news-card">
                    ${imageUrl ? `<img src="${imageUrl}" alt="${escapeHtml(news.title)}" class="news-card-image" onerror="this.style.display='none'">` : ''}
                    <div class="news-card-body">
                        ${news.category_name ? `<span class="news-card-category">${escapeHtml(news.category_name)}</span>` : ''}
                        <h3 class="news-card-title">
                            <a href="/noticia.html?id=${news.id}">${escapeHtml(news.title)}</a>
                        </h3>
                        <p class="news-card-excerpt">${escapeHtml(truncate(news.excerpt || news.content, 150))}</p>
                        <div class="news-card-meta">
                            <span>${formatDate(news.created_at)}</span>
                            <span>${news.views || 0} vistas</span>
                        </div>
                    </div>
                </article>
            `;
        }

        // Render product card
        function renderProductCard(product) {
            const imageUrl = product.image_url || product.imageUrl || '/images/placeholder.jpg';
            const price = product.price ? `$${Number(product.price).toLocaleString('es-AR')}` : 'Consultar';
            return `
                <article class="product-card">
                    <img src="${imageUrl}" alt="${escapeHtml(product.title || product.name)}" class="product-card-image" onerror="this.src='/images/placeholder.jpg'">
                    <div class="product-card-body">
                        <h3 class="product-card-title">
                            <a href="/producto.html?id=${product.id}">${escapeHtml(product.title || product.name)}</a>
                        </h3>
                        <div class="product-card-price">${price}</div>
                        ${product.zone_name ? `<div class="product-card-zone">üìç ${escapeHtml(product.zone_name)}</div>` : ''}
                    </div>
                </article>
            `;
        }

        // Render event card
        function renderEventCard(event) {
            const dateParts = getEventDateParts(event.event_date || event.start_date);
            return `
                <article class="event-card">
                    <div class="event-date">
                        <div class="event-date-day">${dateParts.day}</div>
                        <div class="event-date-month">${dateParts.month}</div>
                    </div>
                    <div class="event-info">
                        <h3 class="event-title">
                            <a href="/evento.html?id=${event.id}">${escapeHtml(event.title)}</a>
                        </h3>
                        <div class="event-location">üìç ${escapeHtml(event.location || event.venue || 'Por confirmar')}</div>
                    </div>
                </article>
            `;
        }

        // Render movie card
        function renderMovieCard(movie) {
            const posterUrl = movie.poster_url || movie.image_url || '/images/movie-placeholder.jpg';
            return `
                <article class="movie-card">
                    <img src="${posterUrl}" alt="${escapeHtml(movie.title)}" class="movie-card-poster" onerror="this.src='/images/placeholder.jpg'">
                    <div class="movie-card-body">
                        <h3 class="movie-card-title">${escapeHtml(movie.title)}</h3>
                        <div class="movie-card-genre">${escapeHtml(movie.genre || '')}</div>
                    </div>
                </article>
            `;
        }

        // Render POI card
        function renderPoiCard(poi) {
            const imageUrl = poi.image_url || '/images/placeholder.jpg';
            return `
                <article class="poi-card">
                    <img src="${imageUrl}" alt="${escapeHtml(poi.name)}" class="poi-card-image" onerror="this.src='/images/placeholder.jpg'">
                    <div class="poi-card-body">
                        ${poi.category_name ? `<span class="poi-card-category">${escapeHtml(poi.category_name)}</span>` : ''}
                        <h3 class="poi-card-title">${escapeHtml(poi.name)}</h3>
                        ${poi.zone_name ? `<div class="poi-card-location">üìç ${escapeHtml(poi.zone_name)}</div>` : ''}
                    </div>
                </article>
            `;
        }

        // Show empty state
        function showEmpty(container, message, icon) {
            container.innerHTML = `
                <div class="empty-state">
                    <div class="icon">${icon}</div>
                    <p>${message}</p>
                </div>
            `;
        }

        // Load home page content
        async function loadHomePage() {
            // Load user menu
            const user = auth.getUser();
            const userMenu = document.getElementById('user-menu');
            const userWidget = document.getElementById('user-widget-content');

            if (user) {
                userMenu.innerHTML = `
                    <span style="color: #e2e8f0; margin-right: 0.5rem;">${escapeHtml(user.name || user.email)}</span>
                    ${user.role === 'admin' || user.role === 'editor' ? '<a href="/editor/" class="btn btn-outline btn-sm" style="margin-right: 0.5rem;">Editor</a>' : ''}
                    <button class="btn btn-outline btn-sm" onclick="auth.logout()">Salir</button>
                `;
                userWidget.innerHTML = `
                    <p style="color: #e2e8f0; font-size: 0.95rem; margin-bottom: 0.5rem;">Hola, ${escapeHtml(user.name || 'Usuario')}</p>
                    <p style="color: #64748b; font-size: 0.8rem; margin-bottom: 0.75rem;">${escapeHtml(user.email)}</p>
                    ${user.role === 'admin' || user.role === 'editor' ? '<a href="/editor/" class="btn btn-primary btn-block mb-2">Panel de Editor</a>' : ''}
                    <button class="btn btn-outline btn-block" onclick="auth.logout()">Cerrar Sesion</button>
                `;
            } else {
                userMenu.innerHTML = `
                    <a href="/login.html" class="btn btn-outline btn-sm" style="margin-right: 0.5rem;">Ingresar</a>
                    <a href="/registro.html" class="btn btn-primary btn-sm">Registrarse</a>
                `;
            }

            // Helper to extract array from API response (handles different formats)
            function extractArray(response, ...keys) {
                if (!response || !response.success) return [];
                const data = response.data;
                if (Array.isArray(data)) return data;
                for (const key of keys) {
                    if (data && Array.isArray(data[key])) return data[key];
                }
                return [];
            }

            // Load news (API returns data.news)
            try {
                const newsResponse = await api.getNews({ limit: 5 });
                const newsFeed = document.getElementById('news-feed');
                const newsData = extractArray(newsResponse, 'news', 'items');

                if (newsData.length > 0) {
                    newsFeed.innerHTML = newsData.map(n => renderNewsCard(n)).join('');
                } else {
                    showEmpty(newsFeed, 'No hay noticias disponibles', 'üì∞');
                }
            } catch (e) {
                console.error('Error loading news:', e);
                showEmpty(document.getElementById('news-feed'), 'Error cargando noticias', '‚ùå');
            }

            // Load products (API returns data.products)
            try {
                const productsResponse = await api.getProducts({ limit: 8 });
                const productsGrid = document.getElementById('products-grid');
                const productsData = extractArray(productsResponse, 'products', 'items');

                if (productsData.length > 0) {
                    productsGrid.innerHTML = productsData.map(p => renderProductCard(p)).join('');
                } else {
                    showEmpty(productsGrid, 'No hay productos disponibles', 'üõí');
                }
            } catch (e) {
                console.error('Error loading products:', e);
                showEmpty(document.getElementById('products-grid'), 'Error cargando productos', '‚ùå');
            }

            // Load events (API returns data.events)
            try {
                const eventsResponse = await api.getEvents({ limit: 4 });
                const eventsList = document.getElementById('events-list');
                const eventsData = extractArray(eventsResponse, 'events', 'items');

                if (eventsData.length > 0) {
                    eventsList.innerHTML = eventsData.map(e => renderEventCard(e)).join('');
                } else {
                    showEmpty(eventsList, 'No hay eventos proximos', 'üìÖ');
                }
            } catch (e) {
                console.error('Error loading events:', e);
                showEmpty(document.getElementById('events-list'), 'Error cargando eventos', '‚ùå');
            }

            // Load movies (API returns data as array, uses status param)
            try {
                const moviesResponse = await api.getMovies({ status: 'now_showing' });
                const moviesGrid = document.getElementById('movies-grid');
                const moviesData = extractArray(moviesResponse, 'movies', 'items');

                if (moviesData.length > 0) {
                    moviesGrid.innerHTML = moviesData.slice(0, 6).map(m => renderMovieCard(m)).join('');
                } else {
                    showEmpty(moviesGrid, 'No hay peliculas en cartelera', 'üé¨');
                }
            } catch (e) {
                console.error('Error loading movies:', e);
                showEmpty(document.getElementById('movies-grid'), 'No hay cartelera disponible', 'üé¨');
            }

            // Load POI (API returns data.items)
            try {
                const poiResponse = await api.getPoi({ limit: 6 });
                const poiGrid = document.getElementById('poi-grid');
                const poiData = extractArray(poiResponse, 'items', 'poi');

                if (poiData.length > 0) {
                    poiGrid.innerHTML = poiData.map(p => renderPoiCard(p)).join('');
                } else {
                    showEmpty(poiGrid, 'No hay lugares para mostrar', 'üó∫Ô∏è');
                }
            } catch (e) {
                console.error('Error loading POI:', e);
                showEmpty(document.getElementById('poi-grid'), 'No hay lugares disponibles', 'üó∫Ô∏è');
            }

            // Load categories widget (API returns data as array)
            try {
                const catResponse = await api.getCategories('noticias');
                const catWidget = document.getElementById('categories-widget');
                const catData = extractArray(catResponse, 'categories', 'items');

                if (catData.length > 0) {
                    catWidget.innerHTML = catData.slice(0, 6).map(c => `
                        <a href="/noticias.html?category=${c.slug || c.id}" class="widget-item">
                            <span>${c.icon || 'üìÅ'}</span>
                            <span>${escapeHtml(c.name)}</span>
                        </a>
                    `).join('');
                } else {
                    catWidget.innerHTML = '<p style="color: #64748b; font-size: 0.85rem;">No hay categorias</p>';
                }
            } catch (e) {
                console.error('Error loading categories:', e);
                document.getElementById('categories-widget').innerHTML = '<p style="color: #64748b; font-size: 0.85rem;">No hay categorias</p>';
            }

            // Load zones widget (API returns data as array)
            try {
                const zonesResponse = await api.getZones();
                const zonesWidget = document.getElementById('zones-widget');
                const zonesData = extractArray(zonesResponse, 'zones', 'items');

                if (zonesData.length > 0) {
                    zonesWidget.innerHTML = zonesData.slice(0, 8).map(z => `
                        <a href="/mercaderia.html?zone=${z.slug || z.id}" class="widget-item">
                            <span>üìç</span>
                            <span>${escapeHtml(z.name)}</span>
                        </a>
                    `).join('');
                } else {
                    zonesWidget.innerHTML = '<p style="color: #64748b; font-size: 0.85rem;">No hay zonas</p>';
                }
            } catch (e) {
                console.error('Error loading zones:', e);
                document.getElementById('zones-widget').innerHTML = '<p style="color: #64748b; font-size: 0.85rem;">No hay zonas</p>';
            }
        }

        // Run on load
        document.addEventListener('DOMContentLoaded', loadHomePage);

        // Mobile menu toggle
        document.querySelector('.menu-toggle')?.addEventListener('click', () => {
            document.querySelector('.sidebar-nav').classList.toggle('active');
        });

        // Global search
        document.getElementById('global-search')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const query = e.target.value.trim();
                if (query) {
                    window.location.href = `/buscar.html?q=${encodeURIComponent(query)}`;
                }
            }
        });
    </script>
</body>
</html>
