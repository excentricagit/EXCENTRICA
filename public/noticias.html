<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noticias - Excentrica</title>
    <meta name="description" content="Las ultimas noticias de Santiago del Estero. Informacion local, politica, deportes, cultura y mas.">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        /* Featured news hero */
        .featured-news {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 2rem;
            background: linear-gradient(145deg, rgba(25, 20, 35, 0.98), rgba(15, 12, 25, 0.99));
            border: 1px solid rgba(168, 85, 247, 0.25);
        }
        .featured-news-image {
            width: 100%;
            height: 350px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        .featured-news:hover .featured-news-image {
            transform: scale(1.03);
        }
        .featured-news-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            background: linear-gradient(to top, rgba(10, 8, 20, 0.98) 0%, rgba(10, 8, 20, 0.85) 50%, transparent 100%);
        }
        .featured-news-badge {
            display: inline-block;
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            color: #fff;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
            box-shadow: 0 2px 15px rgba(168, 85, 247, 0.5);
        }
        .featured-news-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 0.5rem;
            line-height: 1.3;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .featured-news-title a {
            color: inherit;
            text-decoration: none;
        }
        .featured-news-title a:hover {
            color: #c4b5fd;
        }
        .featured-news-excerpt {
            color: #cbd5e1;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .featured-news-meta {
            display: flex;
            gap: 1.5rem;
            color: #94a3b8;
            font-size: 0.85rem;
        }

        /* Section header */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Filter bar */
        .filter-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        .filter-bar select {
            background: rgba(30, 30, 40, 0.9);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 0.6rem 1rem;
            color: #e2e8f0;
            font-size: 0.9rem;
            min-width: 180px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .filter-bar select:hover, .filter-bar select:focus {
            border-color: rgba(168, 85, 247, 0.6);
            outline: none;
        }
        .filter-results {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-left: auto;
        }

        /* News feed */
        .news-feed {
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
        }

        /* News card - Excentrica style */
        .news-card {
            background: linear-gradient(145deg, rgba(25, 20, 35, 0.98), rgba(15, 12, 25, 0.99));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 40px rgba(168, 85, 247, 0.05);
            position: relative;
            display: grid;
            grid-template-columns: 280px 1fr;
        }
        .news-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #a855f7, #7c3aed);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .news-card:hover {
            border-color: rgba(168, 85, 247, 0.5);
            transform: translateX(4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.15);
        }
        .news-card:hover::before {
            opacity: 1;
        }
        .news-card-image-container {
            position: relative;
            overflow: hidden;
            height: 100%;
        }
        .news-card-image {
            width: 100%;
            height: 100%;
            min-height: 180px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        .news-card:hover .news-card-image {
            transform: scale(1.05);
        }
        .news-card-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            color: #fff;
            padding: 0.25rem 0.6rem;
            border-radius: 15px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 10px rgba(168, 85, 247, 0.4);
        }
        .news-card-body {
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
        }
        .news-card-category {
            display: inline-block;
            background: rgba(168, 85, 247, 0.15);
            color: #c4b5fd;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-bottom: 0.6rem;
            border: 1px solid rgba(168, 85, 247, 0.25);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            width: fit-content;
        }
        .news-card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 0.5rem;
            line-height: 1.4;
            letter-spacing: -0.2px;
        }
        .news-card-title a {
            color: inherit;
            text-decoration: none;
            transition: color 0.2s;
        }
        .news-card-title a:hover {
            color: #c4b5fd;
        }
        .news-card-excerpt {
            color: #9ca3af;
            font-size: 0.88rem;
            line-height: 1.55;
            margin-bottom: 0.75rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex: 1;
        }
        .news-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(168, 85, 247, 0.1);
            margin-top: auto;
        }
        .news-card-meta {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            color: #6b7280;
            font-size: 0.75rem;
        }
        .news-card-stats {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .news-card-stat {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            color: #6b7280;
            font-size: 0.75rem;
        }
        .news-card-read-more {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            color: #a855f7;
            font-size: 0.8rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s;
        }
        .news-card-read-more:hover {
            color: #c4b5fd;
            gap: 0.6rem;
        }

        /* Sidebar widgets */
        .widget {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.12), rgba(20, 20, 30, 0.95));
            border: 1px solid rgba(168, 85, 247, 0.25);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }
        .widget-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #a855f7;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        .widget-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .widget-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            border-radius: 8px;
            color: #94a3b8;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }
        .widget-item:hover, .widget-item.active {
            background: rgba(168, 85, 247, 0.15);
            color: #e2e8f0;
        }
        .widget-item.active {
            color: #a855f7;
            font-weight: 500;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }
        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(168, 85, 247, 0.15);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .pagination-btn:hover {
            background: rgba(168, 85, 247, 0.3);
            border-color: rgba(168, 85, 247, 0.5);
        }
        .pagination-btn.active {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            border-color: transparent;
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .news-card {
                grid-template-columns: 1fr;
            }
            .news-card-image {
                height: 180px;
                min-height: 180px;
            }
            .featured-news-image {
                height: 250px;
            }
            .featured-news-title {
                font-size: 1.25rem;
            }
            .featured-news-overlay {
                padding: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar de Navegacion Lateral Fijo -->
    <nav class="sidebar-nav">
        <a href="/" class="sidebar-nav-item">
            <span class="icon">üè†</span>
            <span>Inicio</span>
        </a>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title">Explorar</div>

        <a href="/noticias.html" class="sidebar-nav-item active">
            <span class="icon">üì∞</span>
            <span>Noticias</span>
        </a>
        <a href="/mercaderia.html" class="sidebar-nav-item">
            <span class="icon">üõí</span>
            <span>Mercaderia</span>
        </a>
        <a href="/eventos.html" class="sidebar-nav-item">
            <span class="icon">üìÖ</span>
            <span>Eventos</span>
        </a>
        <a href="/videos.html" class="sidebar-nav-item">
            <span class="icon">üé•</span>
            <span>Videos</span>
        </a>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title">Servicios</div>

        <a href="/gastronomia.html" class="sidebar-nav-item">
            <span class="icon">üçΩÔ∏è</span>
            <span>Gastronomia</span>
        </a>
        <a href="/alojamiento.html" class="sidebar-nav-item">
            <span class="icon">üè®</span>
            <span>Alojamiento</span>
        </a>
        <a href="/transporte.html" class="sidebar-nav-item">
            <span class="icon">üöå</span>
            <span>Transporte</span>
        </a>
        <a href="/servicios.html" class="sidebar-nav-item">
            <span class="icon">üîß</span>
            <span>Servicios</span>
        </a>
        <a href="/puntos-interes.html" class="sidebar-nav-item">
            <span class="icon">üìç</span>
            <span>Turismo</span>
        </a>

        <div class="sidebar-divider"></div>

        <a href="/cine.html" class="sidebar-nav-item">
            <span class="icon">üé¨</span>
            <span>Cine</span>
        </a>
        <a href="/contacto.html" class="sidebar-nav-item">
            <span class="icon">üìû</span>
            <span>Contacto</span>
        </a>
    </nav>

    <header class="header">
        <div class="header-inner">
            <a href="/" class="logo">
                <img src="/assets/logo.png" alt="Logo" style="height: 28px; width: auto;"> Excentrica
            </a>
            <div class="header-search">
                <input type="search" placeholder="Buscar en Excentrica..." />
            </div>
            <button class="menu-toggle"><span></span><span></span><span></span></button>
        </div>
    </header>

    <main class="main">
        <div class="layout-sidebar">
            <!-- Contenido principal -->
            <div class="content">
                <!-- Noticia destacada -->
                <div id="featured-news">
                    <div class="featured-news" style="background: rgba(168, 85, 247, 0.1); height: 350px; display: flex; align-items: center; justify-content: center;">
                        <div class="spinner spinner-lg"></div>
                    </div>
                </div>

                <!-- Header de seccion -->
                <div class="section-header">
                    <h2 class="section-title"><span>üì∞</span> Ultimas Noticias</h2>
                    <span class="filter-results" id="results-count"></span>
                </div>

                <!-- Barra de filtros -->
                <div class="filter-bar">
                    <select id="category-filter">
                        <option value="">Todas las categorias</option>
                    </select>
                </div>

                <!-- Feed de noticias -->
                <div id="news-feed" class="news-feed">
                    <div class="text-center p-5"><div class="spinner spinner-lg mx-auto"></div></div>
                </div>

                <!-- Paginacion -->
                <div id="pagination"></div>
            </div>

            <!-- Sidebar derecho -->
            <aside class="sidebar">
                <!-- Widget de usuario -->
                <div class="widget" id="user-widget">
                    <div class="widget-title">üë§ Mi Cuenta</div>
                    <div id="user-widget-content">
                        <p style="color: #e2e8f0; font-size: 0.9rem; margin-bottom: 0.75rem;">Inicia sesion para guardar noticias y recibir alertas.</p>
                        <button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #a855f7, #7c3aed); border: none; box-shadow: 0 0 15px rgba(168, 85, 247, 0.4); color: #fff;" onclick="window.location.href='/login.html'">Iniciar Sesion</button>
                        <button class="btn btn-block" style="background: transparent; border: 1px solid #a855f7; color: #e2e8f0;" onclick="window.location.href='/registro.html'">Crear Cuenta</button>
                    </div>
                </div>

                <!-- Widget de contenido patrocinado - DESTACADO (para videos de clientes) -->
                <div class="widget" id="ad-widget" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.25), rgba(124, 58, 237, 0.15)); border: 2px solid rgba(168, 85, 247, 0.5); position: relative; overflow: hidden; min-height: 320px;">
                    <!-- Efecto de brillo animado -->
                    <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.05) 50%, transparent 70%); animation: shimmer 3s infinite;"></div>
                    <style>@keyframes shimmer { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }</style>

                    <div style="position: relative; z-index: 1;">
                        <div class="widget-title" style="color: #e9d5ff; font-size: 1rem;">
                            <span style="font-size: 1.1rem;">‚≠ê</span>
                            Espacio Publicitario
                        </div>

                        <!-- Contenedor para video/contenido del cliente -->
                        <div id="ad-content" style="background: rgba(0,0,0,0.3); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; text-align: center; min-height: 200px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                            <div style="width: 70px; height: 70px; margin-bottom: 1rem; background: linear-gradient(135deg, #a855f7, #7c3aed); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; box-shadow: 0 0 25px rgba(168, 85, 247, 0.5);">üì£</div>
                            <p style="color: #fff; font-size: 1.1rem; font-weight: 700; margin-bottom: 0.5rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">Promociona tu Negocio</p>
                            <p style="color: #c4b5fd; font-size: 0.85rem; line-height: 1.5; margin-bottom: 1rem;">Llega a miles de personas en Santiago del Estero</p>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                                <span style="background: rgba(34, 197, 94, 0.2); color: #4ade80; padding: 0.25rem 0.6rem; border-radius: 20px; font-size: 0.7rem; font-weight: 500;">‚úì Alto alcance</span>
                                <span style="background: rgba(59, 130, 246, 0.2); color: #60a5fa; padding: 0.25rem 0.6rem; border-radius: 20px; font-size: 0.7rem; font-weight: 500;">‚úì Videos promocionales</span>
                            </div>
                        </div>

                        <a href="/contacto.html" class="btn btn-block" style="background: linear-gradient(135deg, #fbbf24, #f59e0b); border: none; color: #1f2937; font-weight: 700; padding: 0.75rem; font-size: 0.95rem; box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); text-transform: uppercase; letter-spacing: 0.5px;">
                            Quiero Anunciar
                        </a>
                    </div>
                </div>

                <!-- Widget de categorias -->
                <div class="widget">
                    <div class="widget-title">üìÅ Categorias</div>
                    <div class="widget-list" id="categories-widget">
                        <div class="text-center p-3"><div class="spinner"></div></div>
                    </div>
                </div>

                <!-- Widget de redes sociales -->
                <div class="widget">
                    <div class="widget-title">üåê Seguinos</div>
                    <div style="display: flex; gap: 0.75rem; justify-content: center; padding: 0.5rem 0; flex-wrap: wrap;">
                        <a href="https://facebook.com/excentrica" target="_blank" rel="noopener" title="Facebook" style="width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(168, 85, 247, 0.15); border: 1px solid rgba(168, 85, 247, 0.3); transition: all 0.3s;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#a855f7"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                        </a>
                        <a href="https://instagram.com/excentricaok" target="_blank" rel="noopener" title="Instagram" style="width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(168, 85, 247, 0.15); border: 1px solid rgba(168, 85, 247, 0.3); transition: all 0.3s;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#a855f7"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
                        </a>
                        <a href="https://youtube.com/revistaexcentrica" target="_blank" rel="noopener" title="YouTube" style="width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(168, 85, 247, 0.15); border: 1px solid rgba(168, 85, 247, 0.3); transition: all 0.3s;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#a855f7"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                        </a>
                        <a href="https://open.spotify.com/user/excentrica" target="_blank" rel="noopener" title="Spotify" style="width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(168, 85, 247, 0.15); border: 1px solid rgba(168, 85, 247, 0.3); transition: all 0.3s;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#a855f7"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
                        </a>
                    </div>
                </div>
            </aside>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <h4 class="footer-title">Excentrica</h4>
                    <p class="text-muted">Red social y marketplace de Santiago del Estero, Argentina.</p>
                </div>
                <div>
                    <h4 class="footer-title">Secciones</h4>
                    <div class="footer-links">
                        <a href="/noticias.html" class="footer-link">Noticias</a>
                        <a href="/mercaderia.html" class="footer-link">Mercaderia</a>
                        <a href="/eventos.html" class="footer-link">Eventos</a>
                    </div>
                </div>
                <div>
                    <h4 class="footer-title">Servicios</h4>
                    <div class="footer-links">
                        <a href="/gastronomia.html" class="footer-link">Gastronomia</a>
                        <a href="/alojamiento.html" class="footer-link">Alojamiento</a>
                        <a href="/transporte.html" class="footer-link">Transporte</a>
                    </div>
                </div>
                <div>
                    <h4 class="footer-title">Contacto</h4>
                    <div class="footer-links">
                        <span class="footer-link">contacto@excentrica.com.ar</span>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Excentrica. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="/js/config.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/components.js"></script>
    <script src="/js/app.js"></script>
    <script>
        let currentPage = 1;
        let categories = [];

        // Escape HTML
        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/[&<>"']/g, (m) => ({
                '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
            }[m]));
        }

        // Truncate text
        function truncate(str, length) {
            if (!str) return '';
            return str.length > length ? str.substring(0, length) + '...' : str;
        }

        // Format date
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const now = new Date();
            const diffMs = now - date;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

            if (diffHours < 1) return 'Hace momentos';
            if (diffHours < 24) return `Hace ${diffHours}h`;
            if (diffDays < 7) return `Hace ${diffDays} dias`;
            return date.toLocaleDateString('es-AR', { day: 'numeric', month: 'short' });
        }

        // Check if news is recent
        function isRecentNews(dateStr) {
            if (!dateStr) return false;
            const newsDate = new Date(dateStr);
            const now = new Date();
            const diffHours = (now - newsDate) / (1000 * 60 * 60);
            return diffHours < 48;
        }

        // Render featured news
        function renderFeaturedNews(news) {
            if (!news) {
                document.getElementById('featured-news').innerHTML = '';
                return;
            }
            const imageUrl = news.image_url || '/images/placeholder.svg';
            document.getElementById('featured-news').innerHTML = `
                <article class="featured-news">
                    <img src="${imageUrl}" alt="${escapeHtml(news.title)}" class="featured-news-image" onerror="this.src='/images/placeholder.svg'">
                    <div class="featured-news-overlay">
                        <span class="featured-news-badge">‚ö° Destacada</span>
                        <h2 class="featured-news-title">
                            <a href="/noticia.html?id=${news.id}">${escapeHtml(news.title)}</a>
                        </h2>
                        <p class="featured-news-excerpt">${escapeHtml(truncate(news.summary || news.content, 200))}</p>
                        <div class="featured-news-meta">
                            <span>üìÖ ${formatDate(news.published_at || news.created_at)}</span>
                            <span>üëÅÔ∏è ${news.view_count || 0} vistas</span>
                            ${news.category_name ? `<span>üìÅ ${escapeHtml(news.category_name)}</span>` : ''}
                        </div>
                    </div>
                </article>
            `;
        }

        // Render news card
        function renderNewsCard(news) {
            const imageUrl = news.image_url || '/images/placeholder.svg';
            const isNew = isRecentNews(news.created_at);
            const views = news.view_count || 0;
            const likes = news.like_count || 0;

            return `
                <article class="news-card">
                    <div class="news-card-image-container">
                        <img src="${imageUrl}" alt="${escapeHtml(news.title)}" class="news-card-image" onerror="this.src='/images/placeholder.svg'">
                        ${isNew ? '<span class="news-card-badge">Nueva</span>' : ''}
                    </div>
                    <div class="news-card-body">
                        ${news.category_name ? `<span class="news-card-category">${escapeHtml(news.category_name)}</span>` : ''}
                        <h3 class="news-card-title">
                            <a href="/noticia.html?id=${news.id}">${escapeHtml(news.title)}</a>
                        </h3>
                        <p class="news-card-excerpt">${escapeHtml(truncate(news.summary || news.content, 150))}</p>
                        <div class="news-card-footer">
                            <div class="news-card-meta">
                                <span>üìÖ</span>
                                <span>${formatDate(news.published_at || news.created_at)}</span>
                            </div>
                            <div class="news-card-stats">
                                <span class="news-card-stat">
                                    <span>üëÅÔ∏è</span>
                                    <span>${views}</span>
                                </span>
                                ${likes > 0 ? `
                                    <span class="news-card-stat">
                                        <span>‚ù§Ô∏è</span>
                                        <span>${likes}</span>
                                    </span>
                                ` : ''}
                                <a href="/noticia.html?id=${news.id}" class="news-card-read-more">
                                    Leer mas ‚Üí
                                </a>
                            </div>
                        </div>
                    </div>
                </article>
            `;
        }

        // Render pagination
        function renderPagination(current, total) {
            if (total <= 1) {
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            let html = '<div class="pagination">';
            html += `<button class="pagination-btn" onclick="loadNews(${current - 1})" ${current <= 1 ? 'disabled' : ''}>‚Üê Anterior</button>`;

            for (let i = 1; i <= total; i++) {
                if (i === 1 || i === total || (i >= current - 1 && i <= current + 1)) {
                    html += `<button class="pagination-btn ${i === current ? 'active' : ''}" onclick="loadNews(${i})">${i}</button>`;
                } else if (i === current - 2 || i === current + 2) {
                    html += '<span style="color: #6b7280; padding: 0.5rem;">...</span>';
                }
            }

            html += `<button class="pagination-btn" onclick="loadNews(${current + 1})" ${current >= total ? 'disabled' : ''}>Siguiente ‚Üí</button>`;
            html += '</div>';

            document.getElementById('pagination').innerHTML = html;
        }

        // Load news
        async function loadNews(page = 1) {
            currentPage = page;
            const category = document.getElementById('category-filter').value;
            const newsFeed = document.getElementById('news-feed');

            newsFeed.innerHTML = '<div class="text-center p-5"><div class="spinner spinner-lg mx-auto"></div></div>';

            try {
                const response = await api.getNews({ page, limit: 10, category });

                if (response.success && response.data.news.length > 0) {
                    const news = response.data.news;

                    // Show first news as featured if on first page and no category filter
                    if (page === 1 && !category && news.length > 0) {
                        renderFeaturedNews(news[0]);
                        newsFeed.innerHTML = news.slice(1).map(n => renderNewsCard(n)).join('');
                    } else {
                        document.getElementById('featured-news').innerHTML = '';
                        newsFeed.innerHTML = news.map(n => renderNewsCard(n)).join('');
                    }

                    // Update results count
                    const total = response.data.pagination.total;
                    document.getElementById('results-count').textContent = `${total} noticia${total !== 1 ? 's' : ''}`;

                    renderPagination(response.data.pagination.page, response.data.pagination.pages);
                } else {
                    document.getElementById('featured-news').innerHTML = '';
                    newsFeed.innerHTML = `
                        <div style="text-align: center; padding: 3rem; color: #94a3b8;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üì∞</div>
                            <h3 style="color: #e2e8f0; margin-bottom: 0.5rem;">No hay noticias</h3>
                            <p>No se encontraron noticias con los filtros seleccionados.</p>
                        </div>
                    `;
                    document.getElementById('results-count').textContent = '0 noticias';
                    document.getElementById('pagination').innerHTML = '';
                }
            } catch (e) {
                console.error('Error loading news:', e);
                newsFeed.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: #ef4444;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
                        <h3 style="margin-bottom: 0.5rem;">Error cargando noticias</h3>
                        <p>Por favor, intenta de nuevo mas tarde.</p>
                    </div>
                `;
            }

            Utils.updateUrl({ page: page > 1 ? page : null, category: category || null });
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Load categories for sidebar widget
        async function loadCategoriesWidget() {
            try {
                const response = await api.getCategories('noticias');
                if (response.success && response.data) {
                    categories = response.data;

                    // Populate filter select
                    const select = document.getElementById('category-filter');
                    select.innerHTML = '<option value="">Todas las categorias</option>';
                    categories.forEach(cat => {
                        select.innerHTML += `<option value="${cat.slug}">${cat.icon || ''} ${cat.name}</option>`;
                    });

                    // Populate sidebar widget
                    const widget = document.getElementById('categories-widget');
                    const currentCategory = new URLSearchParams(window.location.search).get('category') || '';

                    widget.innerHTML = `
                        <a href="/noticias.html" class="widget-item ${!currentCategory ? 'active' : ''}" onclick="filterByCategory(''); return false;">
                            <span>üì∞</span>
                            <span>Todas</span>
                        </a>
                        ${categories.map(cat => `
                            <a href="/noticias.html?category=${cat.slug}" class="widget-item ${currentCategory === cat.slug ? 'active' : ''}" onclick="filterByCategory('${cat.slug}'); return false;">
                                <span>${cat.icon || 'üìÅ'}</span>
                                <span>${escapeHtml(cat.name)}</span>
                            </a>
                        `).join('')}
                    `;
                }
            } catch (e) {
                console.error('Error loading categories:', e);
                document.getElementById('categories-widget').innerHTML = '<p style="color: #94a3b8; font-size: 0.85rem;">Error cargando categorias</p>';
            }
        }

        // Filter by category from widget
        function filterByCategory(slug) {
            document.getElementById('category-filter').value = slug;
            loadNews(1);
            // Update widget active state
            document.querySelectorAll('#categories-widget .widget-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.widget-item').classList.add('active');
        }

        // Update user widget
        function updateUserWidget() {
            const user = auth.getUser();
            const widget = document.getElementById('user-widget-content');

            if (user) {
                let panelButtons = '';
                if (user.role === 'admin') {
                    panelButtons += `<button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #ef4444, #dc2626); border: none; color: #fff;" onclick="window.location.href='/admin/'">Panel Admin</button>`;
                    panelButtons += `<button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #a855f7, #7c3aed); border: none; color: #fff;" onclick="window.location.href='/editor/'">Panel Editor</button>`;
                    panelButtons += `<button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #f59e0b, #d97706); border: none; color: #fff;" onclick="window.location.href='/publicista/'">Panel Publicista</button>`;
                } else if (user.role === 'editor' || user.role === 'periodista') {
                    panelButtons += `<button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #a855f7, #7c3aed); border: none; color: #fff;" onclick="window.location.href='/editor/'">Panel Editor</button>`;
                } else if (user.role === 'publicista') {
                    panelButtons += `<button class="btn btn-block mb-2" style="background: linear-gradient(135deg, #f59e0b, #d97706); border: none; color: #fff;" onclick="window.location.href='/publicista/'">Panel Publicista</button>`;
                }

                widget.innerHTML = `
                    <p style="color: #e2e8f0; font-weight: 500; margin-bottom: 0.75rem; text-align: center;">Hola, ${escapeHtml(user.name ? user.name.split(' ')[0] : user.email)}</p>
                    <button class="btn btn-block mb-2" style="background: rgba(168, 85, 247, 0.2); border: 1px solid rgba(168, 85, 247, 0.4); color: #e2e8f0;" onclick="window.location.href='/perfil.html'">Mi Perfil</button>
                    ${panelButtons}
                    <button class="btn btn-block" style="background: transparent; border: 1px solid rgba(239, 68, 68, 0.5); color: #f87171;" onclick="auth.logout()">Cerrar Sesion</button>
                `;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Load categories
            await loadCategoriesWidget();

            // Read URL params
            const params = Utils.getUrlParams();
            if (params.category) {
                document.getElementById('category-filter').value = params.category;
            }

            // Load news
            loadNews(parseInt(params.page) || 1);

            // Update user widget
            updateUserWidget();

            // Event listeners
            document.getElementById('category-filter').addEventListener('change', () => loadNews(1));
        });
    </script>
</body>
</html>
